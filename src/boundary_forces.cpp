#include <sph_boundary_particles/boundary_forces.h>
#include "boundary.cuh"

#include <cmath>

namespace sample_spheres
{

//====================================================================================================  
//====================================================================================================  
//====================================================================================================  
boundary_forces::boundary_forces ()
{

}

//====================================================================================================  
//====================================================================================================  
//====================================================================================================  
boundary_forces::~boundary_forces ()
{

}
//====================================================================================================  
//====================================================================================================  
//====================================================================================================  
SReal Wij(SVec3 ij, SReal h)
{
	static SReal poly = 315.f / (M_PI*powf(h,9));

	SReal len = length(ij);

	if (len > h) return 0.f ;

	return (poly* (powf(h*h - len*len,3)));
}
//====================================================================================================  
//====================================================================================================  
//====================================================================================================  
void boundary_forces::getVbi(std::vector<SReal> & vbi, std::vector<SVec4> boundary_spheres, SReal interaction_radius)
{
	vbi.resize(boundary_spheres.size(),0);
	updateVbi((SReal*)boundary_spheres.data(), (SReal*)vbi.data(), interaction_radius, boundary_spheres.size());
}

} 
